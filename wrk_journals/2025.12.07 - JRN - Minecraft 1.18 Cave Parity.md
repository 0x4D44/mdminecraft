# 2025.12.07 - JRN - Minecraft 1.18 Cave Parity

## Session Start
**Time**: 2025-12-07
**Iteration**: 1
**Objective**: Implement full Minecraft 1.18 "Caves and Cliffs" feature parity for mdminecraft cave generation

## Problem Statement
Upgrade from basic single-carver cave system to complete Minecraft 1.18+ cave generation including:
- Multiple cave types (Cheese, Spaghetti, Noodle)
- Ravines (vertical canyons)
- Aquifer system (water lakes y>30, lava lakes y<10)
- Amethyst geodes (rare spherical structures)
- Complete lush cave decorations (cave vines, moss carpet, spore blossoms, azalea, hanging roots, rooted dirt)
- Deep dark enhancements (sculk sensors, shriekers, catalysts, veins, reinforced deepslate)
- Dripstone blocks (solid form)
- Surface connection detection
- 17 new blocks total

## Implementation Plan

### Phase 1: Multiple Cave Carvers (Cheese/Spaghetti/Noodle)
1. Add `CheeseCaveCarver` - large open caverns (low frequency, high threshold)
2. Add `SpaghettiCaveCarver` - winding tunnels (medium frequency, distance-based)
3. Add `NoodleCaveCarver` - thin passages (high frequency, tight threshold)
4. Test each carver independently

### Phase 2: Aquifer System
1. Create `crates/world/src/aquifer.rs`
2. Implement `AquiferGenerator` with 3D noise
3. Add water lakes (y>30) and lava lakes (y<10)
4. Add magma blocks under lava
5. Add lava(15) and magma_block(105) to blocks.json

### Phase 3: Ravines
1. Add `RavineCarver` to caves.rs
2. Implement 2D path detection + vertical carving
3. Variable width based on noise

### Phase 4: Amethyst Geodes
1. Create `crates/world/src/geode.rs`
2. Implement rare spherical structure generation
3. Add 4 geode blocks: smooth_basalt(107), calcite(108), amethyst_block(109), budding_amethyst(110)

### Phase 5: Lush Cave Decorations
1. Add 6 lush blocks: cave_vines(111), moss_carpet(112), spore_blossom(113), azalea_leaves(114), rooted_dirt(115), hanging_roots(116)
2. Create `LushCaveDecorator` in caves.rs
3. Implement ceiling/floor decoration logic

### Phase 6: Deep Dark Enhancements
1. Add 5 deep dark blocks: sculk_sensor(117), sculk_shrieker(118), sculk_catalyst(119), sculk_vein(120), reinforced_deepslate(121)
2. Create `DeepDarkDecorator` in caves.rs
3. Implement depth-based sculk placement

### Phase 7: Dripstone Enhancements
1. Add dripstone_block(122)
2. Enhance existing `DripstoneGenerator`
3. Replace some stone with dripstone blocks in dripstone biomes

### Phase 8: Surface Connection Detection
1. Add `is_surface_connected()` to `CaveBiome`
2. Add `ceiling_decoration_with_surface()` for different decorations

### Phase 9: Textures
1. Create 18 placeholder 16x16 PNG textures
2. Regenerate texture atlas

### Phase 10: Integration
1. Update `TerrainGenerator` with all new systems
2. Proper generation order (terrain → carvers → aquifers → geodes → decorations)

### Phase 11: Testing
1. Add tests for each cave carver type
2. Add aquifer tests
3. Add geode tests
4. Add decorator tests
5. Integration tests

### Phase 12: Verification
1. cargo build (0 errors, 0 warnings)
2. cargo clippy (0 warnings)
3. cargo test --all (100% passing)

## Work Log

### Iteration 1: Starting Implementation

**Status**: Beginning Phase 1 - Multiple Cave Carvers

Next steps:
1. Read current caves.rs to understand existing structure
2. Add Cheese/Spaghetti/Noodle carvers
3. Test compilation
