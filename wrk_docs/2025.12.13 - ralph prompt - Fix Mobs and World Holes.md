# Ralph Wiggum Prompt: Fix Mobs and World Holes

## Problem Summary
1. **No visible mobs or people** - Despite code for mob spawning, no mobs appear in game
2. **World holes** - There are holes in the terrain where player can fall through to the void

## Investigation Notes

### Mob Spawning Analysis
- `MobSpawner.generate_spawns()` is called when chunks are generated (game.rs:2213)
- Spawn rate is 15% per spawn point with step_by(4) = 16 spawn points per chunk
- Mobs spawn in Plains, Forest, BirchForest, Hills, Savanna, RainForest, Mountains
- Mobs do NOT spawn in: Desert, Taiga, Tundra, Ocean, DeepOcean, Swamp, Badlands, Mushroom

### Possible Mob Issues
1. **Biome check**: Player spawns at (0,0) - what biome is that? If it's a non-spawning biome, no mobs will appear
2. **Rendering**: Mobs are rendered as billboards at game.rs:1811 - verify this code path is reached
3. **mob.dead flag**: Mobs with dead=true are skipped in rendering
4. **mobs vector**: Check if mobs are actually being added to self.mobs

### World Holes Analysis
- Bedrock was fixed to always spawn at y=0 (terrain.rs)
- Cave generation was restricted to y>=5
- Holes might be at chunk boundaries or in specific biome/noise combinations
- Ocean biomes place water, not solid ground - could fall into deep water

## Implementation Tasks

### Task 1: Debug Mob Spawning
1. Add debug logging to `generate_spawns()` to see how many mobs are created per chunk
2. Add logging when mobs are added to the world in game.rs:2213-2214
3. Check if the spawn biome at (0,0) supports mob spawning
4. Verify mobs list is not empty after chunk generation

### Task 2: Fix Mob Visibility
1. Ensure mob rendering code at game.rs:1811+ is being reached
2. Check if billboard rendering is working for mobs
3. Add a fallback spawn - force spawn some test mobs near player at game start
4. Verify mob positions are reasonable (not underground or in sky)

### Task 3: Fix World Holes
1. Check terrain generation for all biomes - ensure solid ground exists
2. For ocean biomes, ensure there's bedrock at y=0 even under water
3. Check chunk boundary stitching - holes might be at 16-block boundaries
4. Add a floor at y=0 for ALL terrain, not just when density > 0

### Task 4: Add Guaranteed Spawns
1. In GameWorld::new(), after terrain generation, spawn 5-10 test mobs near player
2. Use Plains-compatible mobs (Pig, Cow, Sheep) regardless of actual biome
3. Log the spawned mobs positions for debugging

## Key Files
- `crates/world/src/mob.rs` - MobSpawner, MobType::for_biome()
- `crates/world/src/terrain.rs` - Terrain generation, bedrock placement
- `src/game.rs:2213` - Where mobs are spawned on chunk generation
- `src/game.rs:1811` - Where mobs are rendered
- `src/game.rs:~1170` - GameWorld::new() initialization

## Test Commands
```bash
cargo test --all --lib
cargo build
cargo run -- --auto-play
```

## Success Criteria
1. Running the game shows visible mobs (animals) walking around
2. No holes in terrain - player cannot fall through world
3. Debug output shows mobs being spawned and rendered
4. Tests still pass
