# TLS and Networking Notes (2025-11-20)

## Client/Server TLS
- Default client mode: **Secure** (native root store).
- Enable insecure dev mode: set `MDM_INSECURE_TLS=1` (skips certificate verification; avoid in prod).
- Provide server cert/key: set `MDM_SERVER_CERT_PATH` and `MDM_SERVER_KEY_PATH` (PEM, PKCS8). If absent, server generates a self-signed dev cert.
- ALPN: `mdminecraft`.

## Client Message Handling
- Client drains reliable/unreliable channels every frame (non-blocking) to prevent backpressure and ensure prediction reconciliation.

## Integration Test
- New roundtrip test (`crates/net/src/connection.rs::test_input_roundtrip`) verifies handshake + input send + server state receive across QUIC transport.

## Operational Checklist
- Prod/CI: do **not** set `MDM_INSECURE_TLS`; deploy with real certs or trusted CA bundle.
- Local dev quickstart: `MDM_INSECURE_TLS=1 cargo run ...` (logs warning).
## CI additions
- CI runs targeted regressions: net input roundtrip, lighting seam test, and a client binary smoke to catch protocol/lighting regressions early.
