# Input Controls Regression Checklist (2025-11-18)

## Purpose
Ensure the overhauled input system (contexts, cursor capture, movement rework, scripted automation) behaves consistently across gameplay, menu, and automation scenarios. This checklist should be run whenever input code, camera handling, or controls configuration changes.

## Test Matrix
| ID | Area | Scenario | Steps | Expected Result |
|----|------|----------|-------|-----------------|
| CTRL-01 | Launch | Baseline startup | `cargo run --release -- --auto-play` and let it reach gameplay | Game loads without panic, cursor auto-captured, Debug HUD shows `Gameplay — Physics` and sensitivity value > 0 |
| CTRL-02 | Cursor Toggle | Manual toggle key | In gameplay press the configured toggle key (default `F1`) | Cursor releases, HUD mode stays `Gameplay — Physics`, `Cursor Captured` switches to `No` |
| CTRL-03 | Menu Transition | ESC flow | Press `Esc` | Menu shown, cursor visible, HUD shows `Menu` mode |
| CTRL-04 | Resume Gameplay | Return from menu | Click “Resume” (or re-enter via auto-play), ensure cursor capture re-engages | HUD mode returns to `Gameplay — Physics`, mouse look smooth, no jump in camera |
| CTRL-05 | Mouse Look | Raw + window deltas | Move mouse slowly and quickly; verify pitch clamping | Camera tracks deltas with configured sensitivity/invert settings |
| CTRL-06 | WASD Movement | Physics mode | Hold `W`, `A`, `S`, `D` combinations | Movement respects camera yaw, diagonal speed normalized |
| CTRL-07 | Vertical Physics | Jump/Crouch | Tap `Space` while grounded, hold `Left Control` | Jump applies impulse, crouch halves speed and lowers camera |
| CTRL-08 | Sprint Modifier | Shift key | Hold `Shift + W` | Player speed increases to sprint tier |
| CTRL-09 | Fly Toggle | Physics toggle | Press `F4` (or configured action) | HUD mode switches to `Gameplay — Fly`, `Space`/`Ctrl` ascend/descend |
| CTRL-10 | Fly Boost | Sprint while flying | Hold sprint while moving | Movement speed doubles (20u/s) |
| CTRL-11 | Hotbar Scroll | Mouse wheel | Scroll up/down | Selected slot cycles, wraparound works |
| CTRL-12 | Hotbar Digits | Number keys 1-9 | Press digits | Precise slot selection |
| CTRL-13 | Mining Interaction | Left/right clicks | Target block, hold left, tap right | Mining progress updates, block place works |
| CTRL-14 | Scripted Input | Automated smoke | `cargo run -- --auto-play --scripted-input config/scripts/demo.json` | Console logs scripted frames, player performs scripted movements with no panic |
| CTRL-15 | HUD Telemetry | Debug overlay | Toggle `F3`, observe Input section | Mode/cursor/sensitivity values update live |
| CTRL-16 | Config Overrides | Custom controls | Edit `config/controls.toml` to change sensitivity/invert | Relaunch; new values applied and displayed |
| CTRL-17 | Context Isolation | Menu input leak | Hold `W` while entering menu, release there | Upon returning to gameplay no stuck movement |
| CTRL-18 | DeviceEvent Fallback | Relative motion fallback | Disable cursor capture (toggle), move mouse | While uncaptured, no accidental camera rotation |
| CTRL-19 | Scroll Edge Cases | Line vs pixel scroll | Test on touchpad (pixel) and wheel (line) | Hotbar scroll interprets correctly |
| CTRL-20 | Error Handling | Cursor grab failure | On Wayland, check logs when capture fails | Warning printed once, game remains usable |

## Automation Notes
- `config/scripts/demo.json` demonstrates scripted playback; extend with additional traces to cover regressions before merging major input changes.
- Future CI hook: run `cargo run -- --auto-play --scripted-input <script>` using xvfb/wayland headless to ensure determinism.

## Sign-off
- [ ] Engineering
- [ ] QA
- [ ] Design / UX
